<!doctype html>
<html class="no-js" lang="">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>storefrontapp documentation</title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">

        <link rel="icon" type="image/x-icon" href="../images/favicon.ico">
	   <link rel="stylesheet" href="../styles/style.css">
        <link rel="stylesheet" href="../styles/dark.css" media="(prefers-color-scheme: dark)">
    </head>
    <body>

        <div class="navbar navbar-default navbar-fixed-top visible-xs">
            <a href="../" class="navbar-brand">storefrontapp documentation</a>
            <button type="button" class="btn btn-default btn-menu ion-ios-menu" id="btn-menu"></button>
        </div>

        <div class="xs-menu menu" id="mobile-menu">
                <div id="book-search-input" role="search"><input type="text" placeholder="Type to search"></div>            <compodoc-menu></compodoc-menu>
        </div>

        <div class="container-fluid main">
           <div class="row main">
               <div class="hidden-xs menu">
                   <compodoc-menu mode="normal"></compodoc-menu>
               </div>
               <!-- START CONTENT -->
               <div class="content interface">
                   <div class="content-data">












<ol class="breadcrumb">
  <li>Interfaces</li>
  <li
  >
  TestProduct</li>
</ol>

<ul class="nav nav-tabs" role="tablist">
        <li class="active">
            <a href="#info" role="tab" id="info-tab" data-toggle="tab" data-link="info">Info</a>
        </li>
        <li >
            <a href="#source" role="tab" id="source-tab" data-toggle="tab" data-link="source">Source</a>
        </li>
</ul>

<div class="tab-content">
    <div class="tab-pane fade active in" id="c-info">
        <p class="comment">
            <h3>File</h3>
        </p>
        <p class="comment">
            <code>projects/storefrontapp-e2e-cypress/cypress/helpers/wish-list.ts</code>
        </p>




        <section>
            <h3 id="index">Index</h3>
            <table class="table table-sm table-bordered index-table">
                <tbody>
                    <tr>
                        <td class="col-md-4">
                            <h6><b>Properties</b></h6>
                        </td>
                    </tr>
                    <tr>
                        <td class="col-md-4">
                            <ul class="index-list">
                                <li>
                                        <a href="#code" 
>
                                            code
                                        </a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#name" 
>
                                            name
                                        </a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#price" 
>
                                            price
                                        </a>
                                </li>
                                <li>
                                            <span class="modifier">Optional</span>
                                        <a href="#type" 
>
                                            type
                                        </a>
                                </li>
                            </ul>
                        </td>
                    </tr>
                </tbody>
            </table>
        </section>



            <section>
                <h3 id="inputs">Properties</h3>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="code"></a>
                                        <span class="name "><b>code</b>
                                            <a href="#code">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>code:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>





                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="name"></a>
                                        <span class="name "><b>name</b>
                                            <a href="#name">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>name:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="price"></a>
                                        <span class="name "><b>price</b>
                                            <a href="#price">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>price:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/number" target="_blank" >number</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
                    <table class="table table-sm table-bordered">
                        <tbody>
                                <tr>
                                    <td class="col-md-4">
                                        <a name="type"></a>
                                        <span class="name "><b>type</b>
                                            <a href="#type">
                                                <span class="icon ion-ios-link"></span>
                                            </a>
                                        </span>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="col-md-4">
                                        <code>type:         <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>
</code>
                                    </td>
                                </tr>


                                    <tr>
                                        <td class="col-md-4">
                                            <i>Type : </i>        <code><a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/string" target="_blank" >string</a></code>

                                        </td>
                                    </tr>

                                    <tr>
                                        <td class="col-md-4">
                                            <i>Optional</i>
                                        </td>
                                    </tr>




                        </tbody>
                    </table>
            </section>
    </div>


    <div class="tab-pane fade  tab-source-code" id="c-source">
        <pre class="line-numbers compodoc-sourcecode"><code class="language-typescript">import { cheapProduct, user } from &#x27;../sample-data/checkout-flow&#x27;;
import { login, register } from &#x27;./auth-forms&#x27;;
import * as checkoutAsPersistentUser from &#x27;./checkout-as-persistent-user&#x27;;
import * as checkout from &#x27;./checkout-flow&#x27;;
import {
  interceptCheckoutB2CDetailsEndpoint,
  waitForPage,
  waitForProductPage,
} from &#x27;./checkout-flow&#x27;;
import {
  AddressData,
  fillPaymentDetails,
  fillShippingAddress,
  PaymentDetails,
} from &#x27;./checkout-forms&#x27;;
import { generateMail, randomString } from &#x27;./user&#x27;;

interface TestProduct {
  code: string;
  type?: string;
  name?: string;
  price?: number;
}

export const products: TestProduct[] &#x3D; [
  {
    code: &#x27;1934793&#x27;,
    name: &#x27;PowerShot A480&#x27;,
  },
  cheapProduct,
  {
    code: &#x27;779841&#x27;,
    name: &#x27;FUN Flash Single Use Camera&#x27;,
  },
];

export const WishListUser &#x3D; {
  user: &#x27;standard&#x27;,
  registrationData: {
    firstName: &#x27;Winston&#x27;,
    lastName: &#x27;Rumfoord&#x27;,
    password: &#x27;Password123.&#x27;,
    titleCode: &#x27;mr&#x27;,
    email: generateMail(randomString(), true),
  },
};

export function registerWishListUser() {
  register({ ...WishListUser.registrationData });
  cy.url().should(&#x27;not.contain&#x27;, &#x27;register&#x27;);
}

export function loginWishListUser() {
  login(
    WishListUser.registrationData.email,
    WishListUser.registrationData.password
  );
  cy.url().should(&#x27;not.contain&#x27;, &#x27;login&#x27;);
}

export function waitForGetWishList() {
  cy.intercept({
    method: &#x27;GET&#x27;,
    pathname: &#x60;${Cypress.env(&#x27;OCC_PREFIX&#x27;)}/${Cypress.env(
      &#x27;BASE_SITE&#x27;
    )}/users/*/carts/*&#x60;,
    query: {
      lang: &#x27;en&#x27;,
      curr: &#x27;USD&#x27;,
    },
  }).as(&#x27;get_wish_list&#x27;);
}

export function addToWishListAnonymous(product: TestProduct) {
  visitProduct(product);

  cy.get(&#x27;cx-add-to-wishlist .button-add-link&#x27;).click();

  cy.get(&#x27;cx-breadcrumb &gt; h1&#x27;).should(&#x27;contain&#x27;, &#x27;Login&#x27;);

  cy.get(&#x27;cx-login-register .btn-register&#x27;).click();

  registerWishListUser();

  loginWishListUser();

  cy.get(&#x27;cx-product-intro &gt; .code&#x27;).should(&#x27;contain&#x27;, &#x60;${product.code}&#x60;);
}

export function visitProduct(product: TestProduct) {
  const productPage &#x3D; waitForProductPage(product.code, &#x27;productPage&#x27;);

  cy.visit(&#x60;/product/${product.code}&#x60;);

  cy.wait(&#x60;@${productPage}&#x60;);
}

export function addToWishListFromPage() {
  waitForGetWishList();

  cy.get(&#x27;cx-add-to-wishlist .button-add&#x27;).click();

  cy.wait(&#x27;@get_wish_list&#x27;);
}

export function addToWishList(product: TestProduct) {
  const productPage &#x3D; waitForProductPage(product.code, &#x27;productPage&#x27;);

  cy.visit(&#x60;/product/${product.code}&#x60;);

  cy.wait(&#x60;@${productPage}&#x60;).its(&#x27;response.statusCode&#x27;).should(&#x27;eq&#x27;, 200);

  waitForGetWishList();

  cy.get(&#x27;cx-add-to-wishlist .button-add&#x27;).should(&#x27;not.be.disabled&#x27;).click();

  cy.wait(&#x27;@get_wish_list&#x27;);
}

export function verifyProductInWishListPdp() {
  cy.get(&#x27;cx-add-to-wishlist .button-remove&#x27;).should(&#x27;exist&#x27;);
}

export function verifyProductNotInWishListPdp() {
  cy.get(&#x27;cx-add-to-wishlist .button-add&#x27;).should(&#x27;exist&#x27;);
}

export function verifyProductInWishList(product: TestProduct) {
  cy.selectUserMenuOption({
    option: &#x27;Wish List&#x27;,
  });
  waitForGetWishList();
  cy.get(&#x27;cx-wish-list&#x27;)
    .contains(&#x27;.cx-item-list-row&#x27;, product.name)
    .within(() &#x3D;&gt; {
      cy.get(&#x27;.cx-code&#x27;).should(&#x27;contain&#x27;, product.code);
    });
}

export function removeProductFromWishListPage(product: TestProduct) {
  waitForGetWishList();
  getWishListItem(product.name).within(() &#x3D;&gt; {
    cy.get(&#x27;button.cx-remove-btn&#x27;).click();
  });
  cy.wait(&#x27;@get_wish_list&#x27;);
  getWishListItem(product.name).should(&#x27;not.exist&#x27;);
}

export function removeProductFromPdp() {
  waitForGetWishList();

  cy.get(&#x27;cx-add-to-wishlist .button-remove&#x27;).click();

  cy.wait(&#x27;@get_wish_list&#x27;);

  verifyProductNotInWishListPdp();
}

export function removeProductFromCart() {
  cy.get(&#x27;cx-mini-cart&#x27;).click();
  cy.get(&#x27;.cx-item-list-items&#x27;).within(() &#x3D;&gt; {
    cy.findByText(/Remove/i).click();
  });
}

export function addProductToCart(product: TestProduct) {
  cy.intercept(
    &#x27;POST&#x27;,
    &#x60;${Cypress.env(&#x27;OCC_PREFIX&#x27;)}/${Cypress.env(
      &#x27;BASE_SITE&#x27;
    )}/users/*/carts/*/entries?lang&#x3D;en&amp;curr&#x3D;USD&#x60;
  ).as(&#x27;add_to_cart&#x27;);

  getWishListItem(product.name).within(() &#x3D;&gt; {
    cy.get(&#x27;cx-add-to-cart button&#x27;).click();
  });

  cy.wait(&#x27;@add_to_cart&#x27;);

  cy.get(&#x27;cx-added-to-cart-dialog&#x27;).within(() &#x3D;&gt; {
    cy.get(&#x27;.cx-dialog-buttons&gt;.btn-primary&#x27;).click();
  });

  getCartItem(product.name).within(() &#x3D;&gt; {
    cy.get(&#x27;.cx-code&#x27;).should(&#x27;contain&#x27;, product.code);
    cy.get(&#x27;cx-item-counter input&#x27;).should(&#x27;have.value&#x27;, &#x27;1&#x27;);
  });

  verifyProductInWishList(product);
}

export function checkWishListPersisted(product: TestProduct) {
  cy.selectUserMenuOption({
    option: &#x27;Sign Out&#x27;,
  });
  cy.location(&#x27;pathname&#x27;).should(&#x27;equal&#x27;, &#x27;/electronics-spa/en/USD/&#x27;);

  cy.findByText(/Sign in \/ Register/i).click();

  loginWishListUser();

  verifyProductInWishList(product);

  goToProductPageFromWishList(product);

  verifyProductInWishListPdp();
}

export function goToWishList() {
  cy.selectUserMenuOption({
    option: &#x27;Wish List&#x27;,
  });
  waitForGetWishList();
}

export function goToProductPageFromWishList(product: TestProduct) {
  const productPage &#x3D; waitForProductPage(product.code, &#x27;productPage&#x27;);
  cy.get(&#x27;cx-wish-list&#x27;).should(&#x27;be.visible&#x27;);
  cy.get(&#x27;cx-wish-list&#x27;)
    .contains(&#x27;.cx-item-list-row&#x27;, product.name)
    .within(() &#x3D;&gt; {
      cy.get(&#x27;.cx-name&gt;.cx-link&#x27;).click();
    });
  cy.wait(&#x60;@${productPage}&#x60;).its(&#x27;response.statusCode&#x27;).should(&#x27;eq&#x27;, 200);
}

export function checkoutFromWishList(checkoutProducts: TestProduct[]) {
  goToCartAndCheckout(checkoutProducts);
  proceedToCheckout();
  fillAddressForm();
  checkout.verifyDeliveryMethod();
  fillPaymentForm();
  placeOrderWithProducts(checkoutProducts);
  verifyOrderConfirmationPage(checkoutProducts);
}

export function checkoutFromCart(checkoutProducts: TestProduct[]) {
  goToCartAndCheckout(checkoutProducts);
  checkoutAsPersistentUser.selectShippingAddress();
  checkoutAsPersistentUser.selectDeliveryMethod();
  checkoutAsPersistentUser.selectPaymentMethod();
  placeOrderWithProducts(checkoutProducts);
  verifyOrderConfirmationPage(checkoutProducts);
}

function goToCartAndCheckout(checkoutProducts: TestProduct[]) {
  cy.get(&#x27;cx-mini-cart&#x27;).click();
  cy.location(&#x27;pathname&#x27;).should(&#x27;match&#x27;, /\/cart$/);

  for (const product of checkoutProducts) {
    cy.get(&#x27;cx-cart-item-list&#x27;).contains(&#x27;.cx-item-list-row&#x27;, product.code);
  }
}

function proceedToCheckout() {
  const deliveryAddressPage &#x3D; waitForPage(
    &#x27;/checkout/delivery-address&#x27;,
    &#x27;getDeliveryAddressPage&#x27;
  );
  cy.findByText(/proceed to checkout/i).click();
  cy.wait(&#x60;@${deliveryAddressPage}&#x60;)
    .its(&#x27;response.statusCode&#x27;)
    .should(&#x27;eq&#x27;, 200);
}

function fillAddressForm(shippingAddressData: AddressData &#x3D; user) {
  /**
   * Delivery mode PUT intercept is not in verifyDeliveryMethod()
   * because it doesn&#x27;t choose a delivery mode and the intercept might have missed timing depending on cypress&#x27;s performance
   */
  const getCheckoutDetailsAlias &#x3D; interceptCheckoutB2CDetailsEndpoint();
  cy.intercept({
    method: &#x27;PUT&#x27;,
    path: &#x60;${Cypress.env(&#x27;OCC_PREFIX&#x27;)}/${Cypress.env(
      &#x27;BASE_SITE&#x27;
    )}/**/deliverymode?deliveryModeId&#x3D;*&#x60;,
  }).as(&#x27;putDeliveryMode&#x27;);

  cy.get(&#x27;.cx-checkout-title&#x27;).should(&#x27;contain&#x27;, &#x27;Delivery Address&#x27;);
  const deliveryPage &#x3D; waitForPage(
    &#x27;/checkout/delivery-mode&#x27;,
    &#x27;getDeliveryPage&#x27;
  );
  fillShippingAddress(shippingAddressData);
  cy.wait(&#x60;@${deliveryPage}&#x60;).its(&#x27;response.statusCode&#x27;).should(&#x27;eq&#x27;, 200);

  cy.wait(&#x27;@putDeliveryMode&#x27;).its(&#x27;response.statusCode&#x27;).should(&#x27;eq&#x27;, 200);
  cy.wait(&#x60;@${getCheckoutDetailsAlias}&#x60;);
}

function fillPaymentForm(
  paymentDetailsData: PaymentDetails &#x3D; user,
  billingAddress?: AddressData
) {
  cy.get(&#x27;.cx-checkout-title&#x27;).should(&#x27;contain&#x27;, &#x27;Payment&#x27;);
  const reviewPage &#x3D; waitForPage(&#x27;/checkout/review-order&#x27;, &#x27;getReviewPage&#x27;);
  fillPaymentDetails(paymentDetailsData, billingAddress);
  cy.wait(&#x60;@${reviewPage}&#x60;).its(&#x27;response.statusCode&#x27;).should(&#x27;eq&#x27;, 200);
}

function placeOrderWithProducts(checkoutProducts: TestProduct[]) {
  cy.get(&#x27;.cx-review-title&#x27;).should(&#x27;contain&#x27;, &#x27;Review&#x27;);

  for (const product of checkoutProducts) {
    cy.get(&#x27;cx-cart-item-list&#x27;).contains(&#x27;.cx-item-list-row&#x27;, product.code);
  }

  cy.findByText(&#x27;Terms &amp; Conditions&#x27;)
    .should(&#x27;have.attr&#x27;, &#x27;target&#x27;, &#x27;_blank&#x27;)
    .should(
      &#x27;have.attr&#x27;,
      &#x27;href&#x27;,
      &#x60;/${Cypress.env(&#x27;BASE_SITE&#x27;)}/en/USD/terms-and-conditions&#x60;
    );
  cy.get(&#x27;.form-check-input&#x27;).check();
  const orderConfirmationPage &#x3D; waitForPage(
    &#x27;/order-confirmation&#x27;,
    &#x27;getOrderConfirmationPage&#x27;
  );
  cy.get(&#x27;cx-place-order button.btn-primary&#x27;).click();
  cy.wait(&#x60;@${orderConfirmationPage}&#x60;)
    .its(&#x27;response.statusCode&#x27;)
    .should(&#x27;eq&#x27;, 200);
}

function verifyOrderConfirmationPage(checkoutProducts: TestProduct[]) {
  cy.get(&#x27;.cx-page-title&#x27;).should(&#x27;contain&#x27;, &#x27;Confirmation of Order&#x27;);
  cy.get(&#x27;h2&#x27;).should(&#x27;contain&#x27;, &#x27;Thank you for your order!&#x27;);

  for (const product of checkoutProducts) {
    cy.get(&#x27;cx-cart-item-list&#x27;).contains(&#x27;.cx-item-list-row&#x27;, product.code);
  }
}

function getCartItem(name: string) {
  return cy.get(&#x27;cx-cart-item-list&#x27;).contains(&#x27;.cx-item-list-row&#x27;, name);
}

function getWishListItem(name: string) {
  return cy.get(&#x27;cx-wish-list&#x27;).contains(&#x27;.cx-item-list-row&#x27;, name);
}
</code></pre>
    </div>
</div>


                   




                   </div><div class="search-results">
    <div class="has-results">
        <h1 class="search-results-title"><span class='search-results-count'></span> result-matching "<span class='search-query'></span>"</h1>
        <ul class="search-results-list"></ul>
    </div>
    <div class="no-results">
        <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
    </div>
</div>
</div>
               <!-- END CONTENT -->
           </div>
       </div>

       <script>
            var COMPODOC_CURRENT_PAGE_DEPTH = 1;
            var COMPODOC_CURRENT_PAGE_CONTEXT = 'interface';
            var COMPODOC_CURRENT_PAGE_URL = 'TestProduct-2.html';
            var MAX_SEARCH_RESULTS = 15;
       </script>

       <script src="../js/libs/custom-elements.min.js"></script>
       <script src="../js/libs/lit-html.js"></script>
       
       <script type="module" src="../js/menu-wc.js" defer></script>
       <script nomodule src="../js/menu-wc_es5.js" defer></script>

       <script src="../js/libs/bootstrap-native.js"></script>

       <script src="../js/libs/es6-shim.min.js"></script>
       <script src="../js/libs/EventDispatcher.js"></script>
       <script src="../js/libs/promise.min.js"></script>
       <script src="../js/libs/zepto.min.js"></script>

       <script src="../js/compodoc.js"></script>

       <script src="../js/tabs.js"></script>
       <script src="../js/menu.js"></script>
       <script src="../js/libs/clipboard.min.js"></script>
       <script src="../js/libs/prism.js"></script>
       <script src="../js/sourceCode.js"></script>
          <script src="../js/search/search.js"></script>
          <script src="../js/search/lunr.min.js"></script>
          <script src="../js/search/search-lunr.js"></script>
          <script src="../js/search/search_index.js"></script>
       <script src="../js/lazy-load-graphs.js"></script>


    </body>
</html>
